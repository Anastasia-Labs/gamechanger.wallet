
# Cardano Example Dapp

## **Lock and Redeem Smart Contract**

Coin locking transaction ( 5 eUTXOs) and later an unlocking one of previously locked coin, in 2 secuential transactions. Using deployed smart contract.


## Try it online: 

-  Visit [HTML5 Dapp](https://gamechangerfinance.github.io/gamechanger.wallet/examples/Lock%20and%20Redeem%20Smart%20Contract.html)
-  Run [Standalone URL dapp connection](https://beta-wallet.gamechanger.finance/api/2/run/1-H4sIAAAAAAAAA81Y32_bOAz-Vwy_bANyqSzJv_rW2z1suGIb1hYYcBgOlES1xhw7Z8u7dEX-96Nsp0nTdE2LHrI8xRJF8qNI6pNuQle4EsPj8LTW3wKoTPAZDeIsOJtB44K3deUa0C6chAZb3RRzV9QVib-tiyooaU1RXQYkUrUkRVPB6yAO8OL8y8f2Ta-uBIcN_Qu6aiVeVxjUNpg3-L2ou7a87hWhCTQpnQSkmAct6g4rV0C5qb2dBhetV2FwXtbXtKTt3dSjm1Py013PPZ7BWfpu0HVNdfH59BM4csU7f-Xc_PjoiKxCeVW37lgwxo4MzuojmBdHBuZzv7Aj2RvCPcfKYKULbP33Pf2DmIewOW_AAc1-h7Kjz79uQg-OxnnC_M8HFFw3o5EIGOMpaHk7-A7aK5pQxiLQZijNeRxZGQMYUHGkTG4tjwyqLMm5gQTSGOM4zpWJSQAyzQB4LMLl5Nas4LvMCmYk2zZrlMXYcqZ1mhjDeY6ZNCLDhOVWp0rYWPJI2FQbblPJM56qREPEhUhzJXiyaVbuRCsTwfS2WdRxghFKk2cgsihnubEqkTZKpVagUgFGRXGSaissCC5Sq1KQXHIjjbUy3TSbyF1mkwiye2i1wihNGfcQUKcMrVCcZQnPc4k60jbLmCRnEpvwWCrBRGRiLpGiYDKb802z2c4gp4b2bttsniAarXIFwiQmjSVTKdeQ02aillroLNM55ykXPGI85lbEIstZkniwmYrC5dflJGwdfMO3DVVsXyoPpl8IhgmQgDJWPLIxswaTNI8TkcTa2lwaJSOlWQZcc8IumTD0X8jQG_EldtsI1ibmZee69mxVB2NB0Pzw7x0ufAKklAKRjwrnXOY5CZZQXd4u__s7RXDbyIkxDbab1aS6ojSr4UlYwayvwV2LJgTWNL0fvnAH_3zUB4duLtG9fqVBX-F0s7Snd5RN281lr94swzHYnzr1J17vo-7u1ngVy6VH2kPx3XYb3vlijex0aJXnX3xDW3jJunPzzrV9K4FVfPZEM4ZmgDGm5s06HR9B0ne2KZveyvdYKMxti27YpPp3PO1buP-a12Whr9-bPu18EvaCHwZgw8g_HVBU3PU-Zn1tjdGbHAZ6dBjo0S8AnR8GOv8FoIvDQBe_AHR5GOhyE_rXSVj3ZLO3qq_o0MCPNDArfiB19_DDxz5AYVtcVlvd1A-dL1bnxJr2-XE0v3ljfVv1zfSOT7eteeoWY9v_6omvg6JE8wmbWdG2g0sWyha9-U7NCrftQD-404V-xm15cceJFaAx8r1PFz13_tmBcbFi1xtHRlHdnhiEZ-AdD8Id93pCq4zPEeaT7-nLouct489bJp63TPrsatBiQ_mH73eEKUk5ZkCUL7fKyIwp5ApsJIkrEXs1VkKukywHmlOa6DFkWUzEEGSWEr9iYjOOZOvfwlVUlMMFYiA-a6I0mG5fjKeM_GpPBV565De9qjOqr6ea92tWAaZY9nn6f0TSh5Kuem03w-alo7bZKuEpjGis06a_NmOz2Qb8Eu-_w9l7s24CN37gnGSWxyzsm_whYUQvACM6PAz-AjD44WGIF4AhDg9DvgAMunzSJXd5lwfUZf-gBKV_gDrDEvX4IHV6cnZ68seaE9w7Mh9hBcPz1E94waDwqczgvht7cIO7vtxjB4POMba2qKAsr3e9TOFiXjfupB3vkyeVGd72Hn60moFu6tX0I3s82n_odWBPVTtzbwjwtvLhQHkRA-vkfvzp4Tl2Nkg4GfDhOl_spXIXbSENQ0I8Rcc6W1da_O8_X4kn5O8VAAA)

## Source code:

- dapp connection code: [GCScript DSL](Lock%20and%20Redeem%20Smart%20Contract.gcscript)
- frontend (using @gamechanger-finance/gc): [HTML5 dapp](Lock%20and%20Redeem%20Smart%20Contract.html)
- frontend (without official library): [Native HTML5 dapp](Lock%20and%20Redeem%20Smart%20Contract_nolib.html)

Dapp code was autogenerated by [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground)

## GCScript code (dapp connection):
```json
{
  "title": "Lock and Redeem Smart Contract",
  "description": "Coin locking transaction ( 5 eUTXOs) and later an unlocking one of previously locked coin, in 2 secuential transactions. Using deployed smart contract.",
  "type": "script",
  "returnURLPattern": "http://localhost:3000/demo/api/dapp",
  "run": {
    "dependencies": {
      "type": "script",
      "run": {
        "locks": {
          "type": "data",
          "value": [
            {
              "coin": "2600000",
              "datum": "1a0027ac40",
              "datumHash": "bdfeadeebc2251f45aadab51bd9ff21deb8692da6a75e5559bd5daba8c0aa253"
            },
            {
              "coin": "3200000",
              "datum": "1a0030d400",
              "datumHash": "dbfe5f20cc76dd229e84d38e609fc7b3f54213f7cd2f742827b6ca123379b326"
            },
            {
              "coin": "4600000",
              "datum": "1a004630c0",
              "datumHash": "ec56e1e4d98a381909dfb64f174cbab73adb1567cf3fa3237fb7a4242d4dff47"
            },
            {
              "coin": "6400000",
              "datum": "1a0061a800",
              "datumHash": "cbe177026ca1ec70ef3b20862994ec1cf88049096f6254b3031d524ef54d8f92"
            },
            {
              "coin": "8200000",
              "datum": "1a007d1f40",
              "datumHash": "96eedcb9ba3d6d7540b72ca9a6aec4c3c88c922723210252f353890664dff8b1"
            }
          ]
        },
        "stakeCredential": {
          "type": "data",
          "value": "ad03a4ae45b21f50fde67956365cff94db41bc08a2c2862403d8a234"
        },
        "smartContract": {
          "type": "plutusScript",
          "script": {
            "scriptHex": "4746010000222499",
            "lang": "plutus_v2"
          }
        },
        "smartContractAddress": {
          "type": "buildAddress",
          "name": "smartContractAddress",
          "addr": {
            "spendScriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
            "stakePubKeyHashHex": "{get('cache.dependencies.stakeCredential')}"
          }
        }
      }
    },
    "buildLock": {
      "type": "buildTx",
      "name": "LockingTX",
      "tx": {
        "outputs": [
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHashHex": "{get('cache.dependencies.locks.0.datumHash')}"
            },
            "assets": {
              "toBeLocked": {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.locks.0.coin')}"
              }
            }
          },
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHashHex": "{get('cache.dependencies.locks.1.datumHash')}"
            },
            "assets": {
              "toBeLocked": {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.locks.1.coin')}"
              }
            }
          },
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHashHex": "{get('cache.dependencies.locks.2.datumHash')}"
            },
            "assets": {
              "toBeLocked": {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.locks.2.coin')}"
              }
            }
          },
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHashHex": "{get('cache.dependencies.locks.3.datumHash')}"
            },
            "assets": {
              "toBeLocked": {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.locks.3.coin')}"
              }
            }
          },
          {
            "address": "{get('cache.dependencies.smartContractAddress')}",
            "datum": {
              "datumHashHex": "{get('cache.dependencies.locks.4.datumHash')}"
            },
            "assets": {
              "toBeLocked": {
                "policyId": "ada",
                "assetName": "ada",
                "quantity": "{get('cache.dependencies.locks.4.coin')}"
              }
            }
          }
        ],
        "options": {
          "changeOptimizer": "NO"
        }
      }
    },
    "signLock": {
      "type": "signTxs",
      "namePattern": "signed-lock",
      "txs": [
        "{get('cache.buildLock.txHex')}"
      ],
      "detailedPermissions": false
    },
    "submitLock": {
      "type": "submitTxs",
      "namePattern": "submitted-lock",
      "txs": "{get('cache.signLock')}"
    },
    "buildUnlock": {
      "type": "buildTx",
      "name": "UnlockingTX",
      "tx": {
        "inputs": [
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": 0
          },
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": 1
          },
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": 2
          },
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": 3
          },
          {
            "txHash": "{get('cache.buildLock.txHash')}",
            "index": 4
          }
        ],
        "referenceInputs": [
          {
            "txHash": "672e8af629fbd480be2baf14ff9046df4a9c689ad48bc84da88531da48721f03",
            "index": 0
          }
        ],
        "witnesses": {
          "plutus": {
            "scripts": [
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "lang": "{get('cache.dependencies.smartContract.lang')}",
                "scriptSize": "{get('cache.dependencies.smartContract.scriptSize')}",
                "input": {
                  "txHash": "672e8af629fbd480be2baf14ff9046df4a9c689ad48bc84da88531da48721f03",
                  "index": 0
                }
              }
            ],
            "consumers": [
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "datum": {
                  "dataHex": "{get('cache.dependencies.locks.0.datum')}"
                },
                "redeemer": {
                  "type": "spend",
                  "itemIdPattern": "{itemType}:0"
                }
              },
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "datum": {
                  "dataHex": "{get('cache.dependencies.locks.1.datum')}"
                },
                "redeemer": {
                  "type": "spend",
                  "itemIdPattern": "{itemType}:1"
                }
              },
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "datum": {
                  "dataHex": "{get('cache.dependencies.locks.2.datum')}"
                },
                "redeemer": {
                  "type": "spend",
                  "itemIdPattern": "{itemType}:2"
                }
              },
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "datum": {
                  "dataHex": "{get('cache.dependencies.locks.3.datum')}"
                },
                "redeemer": {
                  "type": "spend",
                  "itemIdPattern": "{itemType}:3"
                }
              },
              {
                "scriptHashHex": "{get('cache.dependencies.smartContract.scriptHashHex')}",
                "datum": {
                  "dataHex": "{get('cache.dependencies.locks.4.datum')}"
                },
                "redeemer": {
                  "type": "spend",
                  "itemIdPattern": "{itemType}:4"
                }
              }
            ]
          }
        },
        "options": {
          "collateralCoinSelection": "LASLAD"
        }
      }
    },
    "signUnlock": {
      "type": "signTxs",
      "namePattern": "signed-unlock",
      "txs": [
        "{get('cache.buildUnlock.txHex')}"
      ],
      "detailedPermissions": false
    },
    "submitUnlock": {
      "type": "submitTxs",
      "namePattern": "submitted-unlock",
      "txs": "{get('cache.signUnlock')}"
    },
    "finally": {
      "type": "script",
      "exportAs": "LockAndRedeem",
      "run": {
        "locks": {
          "type": "macro",
          "run": "{get('cache.dependencies.locks')}"
        },
        "smartContract": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContract.scriptHex')}"
        },
        "smartContractHash": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContract.scriptHashHex')}"
        },
        "smartContractAddress": {
          "type": "macro",
          "run": "{get('cache.dependencies.smartContractAddress')}"
        },
        "lockTx": {
          "type": "macro",
          "run": "{get('cache.buildLock.txHash')}"
        },
        "unlockTx": {
          "type": "macro",
          "run": "{get('cache.buildUnlock.txHash')}"
        }
      }
    }
  }
}
```

## Run standalone QR dapp connection: 

You can use [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground) in `QR URL Transport` mode to capture results

[![This GCScript/URL is too large! make it shorter uploading parts to GCFS. Unable to generate QR code](Lock%20and%20Redeem%20Smart%20Contract.png)](https://gamechangerfinance.github.io/gamechanger.wallet/examples/Lock%20and%20Redeem%20Smart%20Contract.png)

## Resources
- [How to connect?](https://www.npmjs.com/package/@gamechanger-finance/gc)
- [Docs and examples on Github](https://github.com/GameChangerFinance/gamechanger.wallet/)
- [GCScript documentation](https://beta-wallet.gamechanger.finance/doc/api/v2)
- [Playground IDE in GameChanger Wallet ](https://beta-wallet.gamechanger.finance/playground)
- [Tutorials on Youtube](https://www.youtube.com/@gamechanger.finance)
- [Support on Discord](https://discord.gg/vpbfyRaDKG)
- [News on Twitter](https://twitter.com/GameChangerOk)
- [Website](https://gamechanger.finance)

## License
MIT 
    
